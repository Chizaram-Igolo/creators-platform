<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <input type="file" name="imageUpload" id="imageUpload">


    <canvas id="my_canvas"></canvas>

    <script>

        document.getElementById('imageUpload').addEventListener('change', (evt) => {
            file = evt.target.files[0]
            var img = document.createElement("img");

            img.style.width = "100px"
            img.src = window.URL.createObjectURL(file);

            img.onload = function () {
                // document.querySelector('body').appendChild(img)


                canvas = document.getElementById("my_canvas");
                var MAX_WIDTH = 100;
                var MAX_HEIGHT = 100;
                var width = img.width;
                var height = img.height;

                if (width > height) {
                    if (width > MAX_WIDTH) {
                        height *= MAX_WIDTH / width;
                        width = MAX_WIDTH;
                    }
                } else {
                    if (height > MAX_HEIGHT) {
                        width *= MAX_HEIGHT / height;
                        height = MAX_HEIGHT;
                    }
                }
                canvas.width = width;
                canvas.height = height;
                var ctx = canvas.getContext("2d");
                ctx.drawImage(img, 0, 0, width, height);
                let a
                canvas.toBlob((blob) => { a = blob })
                console.log(canvas)
                // console.log(canvas.toDataURL(1.0))

                // var image = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");  // here is the most important part because if you dont replace you will get a DOM 18 exception.


                // window.location.href = image; // it will save locally
            }
        })

    </script>
</body>

</html>